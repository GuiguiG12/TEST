<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>G12 Terminal Access</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet" />
  
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.13.4/dist/ethers.umd.min.js"></script>

  <style>
    /* =========================================================
       1. CORE DESIGN TOKENS
       ========================================================= */
    :root {
      /* Brand */
      --magma-core: #E85A04;
      --magma-dim: rgba(232, 90, 4, 0.1);
      --magma-glow: rgba(232, 90, 4, 0.3);

      /* UI Surfaces */
      --bg-root: #050505;       /* Noir profond */
      --bg-panel: #0a0a0a;      /* Panneau légèrement plus clair */
      --bg-card: #0F1115;       /* Cartes */
      
      /* Borders */
      --border-light: rgba(255, 255, 255, 0.08);
      --border-hover: rgba(255, 255, 255, 0.15);
      
      /* Text */
      --text-main: #FFFFFF;
      --text-muted: #888888;
      
      /* Status */
      --success: #10B981;
      
      /* Layout */
      --sidebar-width: 480px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-root);
      color: var(--text-main);
      height: 100vh;
      overflow: hidden; /* On gère le scroll dans les panneaux */
      opacity: 0; transition: opacity 0.5s ease;
    }
    body.is-loaded { opacity: 1; }

    /* Grain Overlay (Subtil) */
    body::before {
        content: ""; position: fixed; inset: 0; pointer-events: none; z-index: 9999;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E");
    }

    /* TYPO UTILS */
    .mono { font-family: 'JetBrains Mono', monospace; }
    .text-magma { color: var(--magma-core); }
    .text-success { color: var(--success); }

    /* =========================================================
       2. LAYOUT : SPLIT SCREEN
       ========================================================= */
    .app-layout {
        display: flex;
        height: 100vh;
        width: 100vw;
    }

    /* --- GAUCHE : VISUAL SIDEBAR --- */
    .left-panel {
        width: var(--sidebar-width);
        background: var(--bg-panel);
        border-right: 1px solid var(--border-light);
        display: flex; flex-direction: column; justify-content: space-between;
        padding: 40px;
        position: relative;
        z-index: 10;
        /* Ombre portée subtile vers la droite */
        box-shadow: 20px 0 50px rgba(0,0,0,0.5);
    }

    .brand-area { display: flex; align-items: center; gap: 12px; }
    .brand-logo { height: 28px; width: auto; }

    /* La Carte Visuelle "Tech" */
    .visual-container {
        flex: 1;
        display: flex; align-items: center; justify-content: center;
        perspective: 1000px;
    }

    .tech-card {
        background: var(--bg-root);
        border: 1px solid var(--border-light);
        border-radius: 16px;
        padding: 24px;
        width: 100%;
        max-width: 380px;
        position: relative;
        overflow: hidden;
        box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        /* Petit tilt 3D */
        transform: rotateY(5deg) rotateX(2deg);
        transition: transform 0.5s ease;
    }
    .visual-container:hover .tech-card { transform: rotateY(0deg) rotateX(0deg); }

    /* Header de la carte tech */
    .tc-header {
        display: flex; justify-content: space-between; align-items: center;
        margin-bottom: 20px; border-bottom: 1px solid var(--border-light); padding-bottom: 12px;
    }
    .tc-title { font-size: 11px; text-transform: uppercase; color: #666; letter-spacing: 1px; }
    .tc-status { display: flex; align-items: center; gap: 6px; font-size: 10px; color: var(--success); }
    .tc-dot { width: 6px; height: 6px; background: var(--success); border-radius: 50%; box-shadow: 0 0 8px var(--success); animation: pulse 2s infinite; }

    /* Code Lines inside card */
    .code-block { font-size: 12px; line-height: 1.6; color: #888; }
    .cl-row { display: flex; gap: 12px; }
    .cl-num { color: #333; select-none: none; }
    .cl-content { color: #aaa; }
    .kw { color: #E85A04; } /* Keyword */
    .str { color: #10B981; } /* String */
    .fn { color: #60A5FA; } /* Function */

    .footer-quote { font-size: 12px; color: #444; line-height: 1.5; max-width: 300px; }
    .footer-quote strong { color: #666; display: block; margin-bottom: 4px; }

    /* --- DROITE : INTERACTION AREA --- */
    .right-panel {
        flex: 1;
        background: var(--bg-root);
        display: flex; flex-direction: column;
        position: relative;
        overflow-y: auto; /* Scrollable si besoin */
    }

    /* Top Bar (Navigation légère) */
    .top-bar {
        height: 80px;
        padding: 0 40px;
        display: flex; align-items: center; justify-content: space-between;
        border-bottom: 1px solid transparent; /* invisible par défaut */
        position: sticky; top: 0; z-index: 20;
        background: rgba(5,5,5,0.8); backdrop-filter: blur(10px);
    }
    
    .back-link {
        display: flex; align-items: center; gap: 8px;
        font-size: 13px; color: #666; font-weight: 500;
        transition: color 0.2s;
    }
    .back-link:hover { color: white; }

    /* AppKit Custom Wrapper pour le rendre visible */
    .wallet-wrapper {
        position: relative; z-index: 50;
    }

    /* Content Area */
    .content-area {
        flex: 1;
        display: flex; flex-direction: column;
        padding: 40px;
        max-width: 1000px; margin: 0 auto; width: 100%;
    }

    /* =========================================================
       3. STATES (LOGIN vs DASHBOARD)
       ========================================================= */
    
    /* --- LOGIN STATE --- */
    #loginState {
        display: flex; flex-direction: column; justify-content: center; height: 100%;
        animation: fadeIn 0.6s ease-out;
    }

    .login-hero h1 { font-size: 42px; font-weight: 700; margin-bottom: 16px; letter-spacing: -1px; }
    .login-hero p { font-size: 16px; color: var(--text-muted); max-width: 480px; line-height: 1.6; margin-bottom: 40px; }

    .login-features {
        display: grid; grid-template-columns: 1fr 1fr; gap: 20px;
        border-top: 1px solid var(--border-light); padding-top: 30px;
    }
    .lf-item { display: flex; align-items: flex-start; gap: 12px; }
    .lf-icon { 
        width: 32px; height: 32px; background: rgba(255,255,255,0.05); 
        border-radius: 8px; display: flex; align-items: center; justify-content: center; 
        color: var(--text-main); font-size: 16px;
    }
    .lf-text h3 { font-size: 14px; font-weight: 600; margin-bottom: 4px; }
    .lf-text p { font-size: 12px; color: #666; }

    /* --- DASHBOARD STATE --- */
    #dashboardState { display: none; animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1); }

    .dash-header { margin-bottom: 40px; }
    .dash-welcome { font-size: 12px; color: var(--magma-core); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
    .dash-title { font-size: 32px; font-weight: 700; }
    .dash-wallet { font-family: 'JetBrains Mono'; color: #666; font-size: 14px; margin-top: 8px; }

    /* Stats Grid */
    .kpi-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 50px; }
    
    .kpi-card {
        background: var(--bg-card); border: 1px solid var(--border-light);
        border-radius: 12px; padding: 24px;
        position: relative; transition: border-color 0.2s;
    }
    .kpi-card:hover { border-color: var(--border-hover); }
    .kpi-label { font-size: 12px; color: #666; text-transform: uppercase; margin-bottom: 8px; }
    .kpi-value { font-size: 28px; font-weight: 600; font-family: 'JetBrains Mono'; letter-spacing: -1px; }
    .kpi-sub { font-size: 12px; color: #444; margin-top: 4px; }

    /* Vault List */
    .vault-list-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .vl-title { font-size: 18px; font-weight: 600; }

    .vault-row {
        background: var(--bg-card); border: 1px solid var(--border-light);
        border-radius: 12px; padding: 20px; margin-bottom: 16px;
        display: flex; align-items: center; justify-content: space-between;
        transition: transform 0.2s, border-color 0.2s;
    }
    .vault-row:hover { transform: translateX(5px); border-color: var(--magma-core); }

    .vr-info { display: flex; align-items: center; gap: 16px; min-width: 200px; }
    .vr-icon { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
    .vr-name { font-weight: 600; font-size: 15px; display: block; }
    .vr-net { font-size: 11px; color: #666; text-transform: uppercase; letter-spacing: 0.5px; }

    .vr-data { text-align: right; }
    .vr-label { font-size: 10px; color: #555; display: block; margin-bottom: 2px; text-transform: uppercase; }
    .vr-val { font-family: 'JetBrains Mono'; font-size: 14px; }

    .vr-actions { display: flex; gap: 10px; }
    .btn-action {
        background: transparent; border: 1px solid var(--border-light); color: white;
        width: 36px; height: 36px; border-radius: 8px; cursor: pointer;
        display: flex; align-items: center; justify-content: center; transition: 0.2s;
    }
    .btn-action:hover { background: white; color: black; }
    .btn-deposit { border-color: var(--magma-core); color: var(--magma-core); }
    .btn-deposit:hover { background: var(--magma-core); color: white; }

    /* =========================================================
       4. ANIMATIONS & RESPONSIVE
       ========================================================= */
    @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); } 70% { box-shadow: 0 0 0 6px rgba(16, 185, 129, 0); } 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); } }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }

    /* MOBILE: Stack Layout */
    @media (max-width: 900px) {
        .app-layout { flex-direction: column; overflow-y: auto; height: auto; }
        .left-panel { width: 100%; height: auto; padding: 30px 20px; border-right: none; border-bottom: 1px solid var(--border-light); }
        .tech-card { display: none; } /* On cache la carte visuelle sur mobile pour gagner de la place */
        .footer-quote { display: none; }
        .right-panel { width: 100%; height: auto; overflow: visible; }
        .content-area { padding: 20px; }
        .login-features { grid-template-columns: 1fr; }
        .kpi-grid { grid-template-columns: 1fr; }
        .vault-row { flex-direction: column; align-items: flex-start; gap: 16px; }
        .vr-actions { width: 100%; justify-content: flex-end; }
        .vr-data { text-align: left; }
    }

    /* =========================================================
       5. MODALS (Minimalist)
       ========================================================= */
    .modal-backdrop {
        position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(5px);
        z-index: 100; display: none; align-items: center; justify-content: center;
    }
    .modal-backdrop.open { display: flex; animation: fadeIn 0.2s; }

    .modal-window {
        background: #0E0E0E; border: 1px solid #222; width: 100%; max-width: 400px;
        border-radius: 16px; padding: 30px; position: relative;
        box-shadow: 0 20px 50px black;
    }
    .mw-title { font-size: 16px; font-weight: 600; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
    .mw-input-group { background: #050505; border: 1px solid #222; border-radius: 8px; padding: 12px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .mw-input-group input { background: transparent; border: none; font-size: 20px; color: white; width: 60%; font-family: 'JetBrains Mono'; outline: none; }
    .mw-btn { width: 100%; padding: 14px; border-radius: 8px; border: none; background: white; color: black; font-weight: 600; cursor: pointer; transition: 0.2s; }
    .mw-btn:hover { background: #ddd; }
    .close-modal { position: absolute; top: 20px; right: 20px; background: none; border: none; color: #555; cursor: pointer; font-size: 20px; }
  </style>
</head>
<body>

  <div class="app-layout">
    
    <aside class="left-panel">
        <div class="brand-area">
            <img src="logo_g12.svg" alt="G12 Labs" class="brand-logo">
        </div>

        <div class="visual-container">
            <div class="tech-card">
                <div class="tc-header">
                    <span class="tc-title">System Monitor</span>
                    <div class="tc-status">
                        <div class="tc-dot"></div> ONLINE
                    </div>
                </div>
                <div class="code-block mono">
                    <div class="cl-row"><span class="cl-num">01</span> <span class="cl-content"><span class="kw">import</span> risk_engine</span></div>
                    <div class="cl-row"><span class="cl-num">02</span> <span class="cl-content"><span class="kw">class</span> <span class="fn">VaultController</span>:</span></div>
                    <div class="cl-row"><span class="cl-num">03</span> <span class="cl-content">&nbsp;&nbsp;<span class="kw">def</span> <span class="fn">check_solvency</span>(self):</span></div>
                    <div class="cl-row"><span class="cl-num">04</span> <span class="cl-content">&nbsp;&nbsp;&nbsp;&nbsp;nav = <span class="fn">get_onchain_nav</span>()</span></div>
                    <div class="cl-row"><span class="cl-num">05</span> <span class="cl-content">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kw">if</span> nav > hurdle_rate:</span></div>
                    <div class="cl-row"><span class="cl-num">06</span> <span class="cl-content">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="fn">rebalance_positions</span>()</span></div>
                    <div class="cl-row"><span class="cl-num">07</span> <span class="cl-content">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kw">return</span> <span class="str">"SECURE"</span></span></div>
                    <div class="cl-row"><span class="cl-num">08</span> <span class="cl-content"></span></div>
                    <div class="cl-row"><span class="cl-num">09</span> <span class="cl-content" style="color:#444;"># Last update: 24ms ago</span></div>
                </div>
            </div>
        </div>

        <div class="footer-quote">
            <strong>Institutional-Grade Infrastructure</strong>
            Non-custodial vaults executing systematic strategies with strict risk parameters.
        </div>
    </aside>

    <main class="right-panel">
        
        <div class="top-bar">
            <a href="index.html" class="back-link">
                <i class="ph ph-arrow-left"></i> Return Home
            </a>
            
            <div class="wallet-wrapper">
                <appkit-button label="Connect Wallet" balance="show"></appkit-button>
            </div>
        </div>

        <div class="content-area">
            
            <div id="loginState">
                <div class="login-hero">
                    <h1>Access your<br>Capital.</h1>
                    <p>
                        Secure access to G12 Labs vaults. 
                        Connect your wallet to view real-time performance, manage deposits, and track your yield.
                    </p>
                </div>
                
                <div class="login-features">
                    <div class="lf-item">
                        <div class="lf-icon"><i class="ph ph-shield-check"></i></div>
                        <div class="lf-text">
                            <h3>Audited Contracts</h3>
                            <p>Built on Enzyme Finance infrastructure.</p>
                        </div>
                    </div>
                    <div class="lf-item">
                        <div class="lf-icon"><i class="ph ph-chart-line-up"></i></div>
                        <div class="lf-text">
                            <h3>Real-time NAV</h3>
                            <p>Live on-chain valuation of assets.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="dashboardState">
                
                <div class="dash-header">
                    <div class="dash-welcome">Welcome Back</div>
                    <div class="dash-title">Portfolio Overview</div>
                    <div class="dash-wallet" id="userAddressDisplay">0x...</div>
                </div>

                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-label">Total Invested</div>
                        <div class="kpi-value" id="totalValue">$0.00</div>
                        <div class="kpi-sub">Across 2 vaults</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Net Earnings</div>
                        <div class="kpi-value" style="color:var(--magma-core);">--</div>
                        <div class="kpi-sub">Realized + Unrealized</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Wallet Balance</div>
                        <div class="kpi-value" id="usdcBalance">0.00</div>
                        <div class="kpi-sub">USDC available</div>
                    </div>
                </div>

                <div class="vault-list-header">
                    <div class="vl-title">Active Positions</div>
                </div>

                <div class="vault-row">
                    <div class="vr-info">
                        <img src="favicon_arbitrum.svg" class="vr-icon" alt="Arb">
                        <div>
                            <span class="vr-name">DeFi Yield</span>
                            <span class="vr-net">Arbitrum One</span>
                        </div>
                    </div>
                    <div class="vr-data">
                        <span class="vr-label">Your Share</span>
                        <span class="vr-val" id="arbShares">0.00 G12</span>
                    </div>
                    <div class="vr-data">
                        <span class="vr-label">Value</span>
                        <span class="vr-val" id="arbValue">$0.00</span>
                    </div>
                    <div class="vr-actions">
                        <button class="btn-action btn-deposit" onclick="openModal('deposit', 'Arbitrum')"><i class="ph ph-plus"></i></button>
                        <button class="btn-action" onclick="openModal('withdraw', 'Arbitrum')"><i class="ph ph-minus"></i></button>
                    </div>
                </div>

                <div class="vault-row">
                    <div class="vr-info">
                        <img src="favicon_base.jpeg" class="vr-icon" alt="Base">
                        <div>
                            <span class="vr-name">Stable Yield</span>
                            <span class="vr-net">Base Network</span>
                        </div>
                    </div>
                    <div class="vr-data">
                        <span class="vr-label">Your Share</span>
                        <span class="vr-val" id="baseShares">0.00 xG12</span>
                    </div>
                    <div class="vr-data">
                        <span class="vr-label">Value</span>
                        <span class="vr-val" id="baseValue">$0.00</span>
                    </div>
                    <div class="vr-actions">
                        <button class="btn-action btn-deposit" onclick="openModal('deposit', 'Base')"><i class="ph ph-plus"></i></button>
                        <button class="btn-action" onclick="openModal('withdraw', 'Base')"><i class="ph ph-minus"></i></button>
                    </div>
                </div>

            </div> </div>
    </main>

  </div>

  <div class="modal-backdrop" id="txModal">
      <div class="modal-window">
          <button class="close-modal" onclick="closeModal()"><i class="ph ph-x"></i></button>
          <div class="mw-title">
              <span id="modalActionIcon"><i class="ph ph-arrows-left-right"></i></span>
              <span id="modalTitle">Transaction</span>
          </div>
          
          <div style="font-size:12px; color:#666; margin-bottom:10px;">AMOUNT (USDC)</div>
          <div class="mw-input-group">
              <input type="number" placeholder="0.00" id="txAmount">
              <span style="font-size:12px; color:var(--magma-core); font-weight:700; cursor:pointer;">MAX</span>
          </div>

          <div style="font-size:11px; color:#444; margin-bottom:20px; text-align:center;">
              Network: <span id="modalNetwork" style="color:#888;">--</span>
          </div>

          <button class="mw-btn" id="modalBtnAction">CONFIRM</button>
      </div>
  </div>

  <script type="module">
    import { createAppKit } from 'https://cdn.jsdelivr.net/npm/@reown/appkit@1.8.15/+esm'
    import { EthersAdapter } from 'https://cdn.jsdelivr.net/npm/@reown/appkit-adapter-ethers@1.8.15/+esm'

    // --- CONFIG ---
    const projectId = '5f9c4ad6a6cadf402f5815fa8f07308c';
    const networks = [
      { id: 42161, name: 'Arbitrum One', nativeCurrency: { name: 'Ether', symbol: 'ETH', decimals: 18 }, rpcUrls: { default: { http: ['https://arb1.arbitrum.io/rpc'] } } },
      { id: 8453, name: 'Base', nativeCurrency: { name: 'Ether', symbol: 'ETH', decimals: 18 }, rpcUrls: { default: { http: ['https://mainnet.base.org'] } } }
    ];

    // --- INIT APPKIT ---
    const modal = createAppKit({
      adapters: [new EthersAdapter()],
      networks,
      projectId,
      themeMode: 'dark',
      themeVariables: {
        '--w3m-accent': '#E85A04', 
        '--w3m-border-radius-master': '2px',
        '--w3m-font-family': 'Inter, sans-serif'
      }
    });

    // --- LOGIC ---
    const loginState = document.getElementById('loginState');
    const dashboardState = document.getElementById('dashboardState');
    const userAddressDisplay = document.getElementById('userAddressDisplay');

    modal.subscribeProvider(({ address, isConnected }) => {
        if (isConnected && address) {
            // SHOW DASHBOARD
            loginState.style.display = 'none';
            dashboardState.style.display = 'block';
            userAddressDisplay.textContent = address.slice(0,6) + '...' + address.slice(-4);
            
            // Here you would trigger data loading (balances, API...)
            console.log("Connected:", address);
        } else {
            // SHOW LOGIN
            loginState.style.display = 'flex';
            dashboardState.style.display = 'none';
        }
    });

    // Fade In Body
    window.addEventListener('DOMContentLoaded', () => {
        document.body.classList.add('is-loaded');
    });
  </script>

  <script>
      const modalBackdrop = document.getElementById('txModal');
      const modalTitle = document.getElementById('modalTitle');
      const modalNetwork = document.getElementById('modalNetwork');
      const modalBtn = document.getElementById('modalBtnAction');

      window.openModal = function(action, network) {
          modalBackdrop.classList.add('open');
          modalNetwork.textContent = network.toUpperCase();
          if(action === 'deposit') {
              modalTitle.textContent = "Deposit USDC";
              modalBtn.textContent = "CONFIRM DEPOSIT";
          } else {
              modalTitle.textContent = "Withdraw Funds";
              modalBtn.textContent = "REQUEST WITHDRAWAL";
          }
      }

      window.closeModal = function() {
          modalBackdrop.classList.remove('open');
      }
  </script>

</body>
</html>
